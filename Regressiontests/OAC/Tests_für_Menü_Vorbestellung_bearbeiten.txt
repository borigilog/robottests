*** Settings ***
Library           Selenium2Library
Library           robot.libraries.String
Resource          ../resources-1.html

*** Test Cases ***
Check Page Contents
    [Documentation]    Test überrüft alle Elemente der Search Page - Label, Eingabefelder
    OpenSearch Page PreOrders    Hauptmandant
    Check Search Page Elements
    [Teardown]    Close Browser

Test Vorbestellungen bearbeiten Seitenstruktur
    [Documentation]    Test um zu überprüfen, ob Button "Zurück" auf Seite der Suchergebnisse aktiv und funktioniert
    Login to RLX Website
    Select Mandator    Hauptmandant
    Select SubMenü    Nachbestellung/Ersatz    Vorbestellung bearbeiten
    Wait Until Element is visible    //div[contains(text(),"Informationen zu Change Peak Vorbestellungen")]
    Page Should Contain    Bitte geben Sie die Kriterien ein, die von der gesuchten Bestellung bekannt sind:
    Input Text    //input[contains(@id,"-order_number")]    %
    Click Element    //button//div[contains(text(),"Suche starten")]
    Wait Until Element is Visible    //div[contains(text(),"passende Bestellungen wurden gefunden")]
    ${search_result}    Get Text    //div[contains(text(),"passende Bestellungen wurden gefunden")]
    Click Element    //button//div[contains(text(),"Zurück")]
    [Teardown]    Close Browser

Test Search All Orders
    [Documentation]    Test überprüft den Korrekten Text im Header der Suchergebnisse bei den Vorbestellungen.
    ...
    ...    "- passende Bestellungen gefunden"
    Open Search Page PreOrders    Hauptmandant
    Input Text    //input[contains(@id,'-order_number')]    %
    Click Element    //button//div[contains(text(),'Suche')]
    Wait Until Element is Visible    //div[contains(text(),"passende Bestellungen wurden gefunden") ]
    [Teardown]    Close Browser

Test Search PreOrders from Name
    [Documentation]    Tested die Anzahl der Suchergebnisse wenn im gegenwärtigen Stand der Manualguide DB nach Vorbestellungen für den MA Mustermann gesucht wird.
    ...
    ...    aktuell erwartete Anzahl = 3
    Open Search Page PreOrders    Hauptmandant
    Search For Item    order_name    Muster
    Wait Until Element is Visible    //div[contains(text(),"gefunden") ]
    ${SearchErgebnisse} =    Get Number of Search Results    gefunden
    Run Keyword If    ${SearchErgebnisse} == 2    Log    Passed
    [Teardown]    Close Browser

Test Search PreOrders from Org-Unit - 1
    [Documentation]    Testet die Suche von Vorbestellungen nach Org-Einheit
    ...
    ...    Eingabe falscher Org-Einheit
    ...
    ...    erwartetes Ergebnis = keine Suchergebnisse
    Open Search Page preOrders    Hauptmandant
    Search For Item    -name    Mustermann
    Wait Until Element is Visible    //div[contains(@class,'popover look_popover_alert look_alert')]
    [Teardown]    Close Browser

Check PreOrder Edit Funktion
    [Documentation]    Test prüft die Funktion des Buttons "Bearbeiten" nach Selektion einer Vorbestellung aus den suchergebnissen.
    Open Search Page Preorders    Hauptmandant
    Search For Item    order_number    %
    Wait Until Element is Visible    //div[contains(text(),"gefunden") ]
    Click Element    //table//tr[contains(@data-rowindex,'0')]
    Click Element    //button//div[contains(text(),'Bearbeiten')]
    Wait Until Element is Visible    //div[contains(text(),'Bestellung für:')]
    [Teardown]    Close Browser

Check Menüpoint Vorbestellung bearbeiten für Submandant
    [Documentation]    Test verifies whether the Sub menu Vorbestellung bearbeiten is not available within the Sub Mandator Submandant1
    Login to RLX Website
    Select Mandator    Submandant1
    Run Keyword And Expect Error    did not match any element    Select SubMenü    Nachbestellung/Ersatz    Vorbestellung bearbeiten
    [Teardown]    Close Browser

Check Content of Pre-Order O103438
    Open Search Page PreOrders    Hauptmandant
    Search For Item    -name    %
    Wait Until Element is Visible    //div[contains(text(),"gefunden") ]
    Click Element    //table//tr[contains(@data-rowindex,'2')]
    Click Element    //button//div[contains(text(),'Bearbeiten')]
    Wait Until element is Visible    //div[contains(text(),'Bestellung für:')]
    ${bestand_aktuell}    Get Text    //td[contains(@class,'_EQW_col_currentItems')]
    Run Keyword If    ${bestand_aktuell} == '0'    log    Passed
    [Teardown]    Close Browser
