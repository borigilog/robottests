*** Variables ***
# ~~~~~~~~~ checkboxes
${chkShowOnlyOpenBills}    /$flow_main/$flow_content/ShowOnlyOpenBills
${chkShowProcessedBills}    /$flow_main/$flow_content/ShowProcessedBills
${chkShowProformaBills}    /$flow_main/$flow_content/ShowProformaBills
${chkPrintLogo}    /$flow_main/$flow_content/Print_Logo
${chkAddCopy}     /$flow_main/$flow_content/cbx_AddCopy
# ~~~~~~~~~ textfield
${txtEmail}       /$flow_main/$flow_content/email
# ~~~~~~~ buttons
${btnCreateBill}    /$flow_main/$flow_content/createBill
${btnAbort}       /$flow_main/$flow_content/abort
${btnThirdParty}    /$flow_main/$flow_content/thirdParty
${btnProForma}    /$flow_main/$flow_content/proForma
# ~~~~~~~ invoices list
${listInvoice}    /$flow_main/$flow_content/issue_list
# ~~~~~~~ invoices col
${colInvoiceNumber}    /$flow_main/$flow_content/issue_list/$col_invoiceNumber
${colDescription}    /$flow_main/$flow_content/issue_list/$col_description
${colStatus}      /$flow_main/$flow_content/issue_list/$col_status
${colCreationDate}    /$flow_main/$flow_content/issue_list/$col_creationDate
${colItems}       /$flow_main/$flow_content/issue_list/$col_items
# ~~~~~~~ sql
${expectedBills_SQL}    SELECT TOP(1)Bills.BillingNo FROM Bills INNER JOIN Overview_Mandators ON Bills.MandatorID = Overview_Mandators.ConcernID WHERE (Bills.IsDeleted = 0) AND (Overview_Mandators.Mandant = 'Hauptmandant')

*** Keywords ***
Get InvoiceID
    [Arguments]    ${Id}    ${Col}    ${Value}=${EMPTY}
    ${Value}=    Get Stripped String    ${Value}
    Run Keyword If    '${Value}' == '${EMPTY}'    Log    Es konnte keine entsprechende Rechnung gefunden werden!    WARN
    ${ElementId}    Get ElementID from List    ${Id}    ${Col}    ${Value}
    Run Keyword If    '${Value}' != '${EMPTY}' and '${ElementId}' == '${EMPTY}'    Fail    Die Rechnung (${Value}) konnte nicht gefunden werden!
    [Return]    ${ElementId}

Get Stripped String
    [Arguments]    ${Value}=${EMPTY}
    Return From Keyword If    '${Value}' == '${NONE}'    ${EMPTY}
    Return From Keyword If    '${Value}' == '${EMPTY}'    ${EMPTY}
    ${strippedValue}    Strip String    ${Value}
    #Log To Console    Get Stripped String--->${strippedValue}
    [Return]    ${strippedValue}

Check Invoice is selectable
    [Arguments]    ${Id}
    ${selectInvoice}=    Set Variable if    '${Id}'=='${EMPTY}'    ${FALSE}    ${TRUE}
    Run Keyword If    '${selectInvoice}' == '${TRUE}'    Log    Eine entsprechende Rechnung wurde gefunden und kann ausgewählt werden    INFO
    Run Keyword If    '${selectInvoice}' == '${FALSE}'    Log    Eine entsprechende Rechnung wurde nicht gefunden und kann auch nicht ausgewählt werden    WARN
    [Return]    ${selectInvoice}

Select InvoiceID
    [Arguments]    ${Id}
    Click Element    ${Id}
    Wait until Page is unfreezed
    Check List ElementId is selected    ${Id}    sel
